@model PaginatedList<ContactDto>

    <div class="container-fluid">
        <div class="ui-view">
            <div class="row mb-2">
                <div class="col-md-12">
                    <h5>Manage Contacts</h5>
                </div>
            </div>

            <!-- Filter Box -->
            <div class="filter-box" id="filterBox">
                <form method="get" asp-action="ManageContacts">
                    <input type="hidden" name="tenantId" value="1" />
                    <input type="hidden" name="pageNumber" value="1" />
                    <input type="hidden" name="pageSize" value="@Model.PageSize" />

                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Name</label>
                            <input type="text" class="form-control" name="name" value="@Context.Request.Query[" name"]">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Phone No.</label>
                            <input type="text" class="form-control" name="phone" value="@Context.Request.Query[" phone"]">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Status</label>
                            <select class="form-control" name="status">
                                <option value="">All</option>
                                <option value="enabled" selected='@(Context.Request.Query["status"] == "enabled")'>Enabled</option>
                                <option value="disabled" selected='@(Context.Request.Query["status"] == "disabled")'>Disabled</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Country</label>
                            <input type="text" class="form-control" name="country" value="@Context.Request.Query[" country"]">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Language</label>
                            <input type="text" class="form-control" name="language" value="@Context.Request.Query[" language"]">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Channel</label>
                            <input type="text" class="form-control" name="channel" value="@Context.Request.Query[" channel"]">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Source</label>
                            <input type="text" class="form-control" name="source" value="@Context.Request.Query[" source"]">
                        </div>
                        <div class="col-md-3 mb-3 d-flex align-items-end">
                            <a href="@Url.Action(" ManageContacts", new { tenantId=1, pageNumber=1, pageSize=Model.PageSize })"
                               class="btn btn-outline-secondary mr-2">Clear All</a>
                            <button type="submit" class="btn nx-btn-primary">Apply</button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Employee Grid -->
            <div class="card nx-card">
                <div class="card-body nx-card-body">
                    <!-- Search and Actions -->
                    <div class="row mb-2">
                        <div class="col-md-8">
                            <form method="get" asp-action="ManageContacts">
                                <input type="hidden" name="tenantId" value="1" />
                                <input type="hidden" name="pageNumber" value="1" />
                                <input type="hidden" name="pageSize" value="@Model.PageSize" />
                                <!-- Preserve filter values -->
                                <input type="hidden" name="name" value="@Context.Request.Query[" name"]" />
                                <input type="hidden" name="phone" value="@Context.Request.Query[" phone"]" />
                                <input type="hidden" name="status" value="@Context.Request.Query[" status"]" />
                                <input type="hidden" name="country" value="@Context.Request.Query[" country"]" />
                                <input type="hidden" name="language" value="@Context.Request.Query[" language"]" />
                                <input type="hidden" name="channel" value="@Context.Request.Query[" channel"]" />
                                <input type="hidden" name="source" value="@Context.Request.Query[" source"]" />

                                <div class="input-group">
                                    <button class="btn btn-outline-secondary" id="filterBtn" type="button">
                                        <svg class="icon-filter" viewBox="0 0 24 24" width="16" height="16">
                                            <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" />
                                        </svg> Filter
                                    </button>
                                    <input type="text" class="form-control" name="search" placeholder="Search..." value="@Context.Request.Query[" search"]">
                                    <button class="btn btn-outline-secondary" type="submit">
                                        <i class="icon-magnifier"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div class="col-md-4">
                            <div class="text-right">
                                <button class="btn btn-warning text-white font-weight-bold" id="newEmployeeBtn">
                                    <i class="fa fa-user-plus"></i>  Add Contact
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary">
                                <i class="fa fa-cloud-upload"></i>  Bulk Contact Upload
                            </button>
                        </div>
                        <div class="col-md-6"></div>
                        <div class="col-md-3">
                            <a class="nav-link font-weight-bold text-right" href="#"><i class="fa fa-download"></i> Export All</a>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="table-responsive">
                                <table class="table employee-table">
                                    <thead>
                                        <tr>
                                            <th>
                                                <input type="checkbox" id="selectAll">
                                            </th>
                                            <th>
                                                <a asp-action="ManageContacts"
                                                   asp-route-tenantId="1"
                                                   asp-route-pageNumber="@Model.PageNumber"
                                                   asp-route-pageSize="@Model.PageSize"
                                                   asp-route-search="@Context.Request.Query[" search"]"
                                                   asp-route-name="@Context.Request.Query[" name"]"
                                                   asp-route-phone="@Context.Request.Query[" phone"]"
                                                   asp-route-status="@Context.Request.Query[" status"]"
                                                   asp-route-country="@Context.Request.Query[" country"]"
                                                   asp-route-language="@Context.Request.Query[" language"]"
                                                   asp-route-channel="@Context.Request.Query[" channel"]"
                                                   asp-route-source="@Context.Request.Query[" source"]"
                                                   asp-route-sortColumn="DisplayName"
                                                   asp-route-sortDirection='(Context.Request.Query["sortColumn"] == "DisplayName" && Context.Request.Query["sortDirection"] == "asc") ? "desc" : "asc"'>
                                                    Name
                                                    @if (Context.Request.Query["sortColumn"] == "DisplayName")
                                                    {
                                                    <i class='fa @(Context.Request.Query["sortDirection"] == "asc" ? "fa-arrow-up" : "fa-arrow-down")'></i>
                                                    }
                                                </a>
                                            </th>
                                            <th>
                                                <a asp-action="ManageContacts"
                                                   asp-route-tenantId="1"
                                                   asp-route-pageNumber="@Model.PageNumber"
                                                   asp-route-pageSize="@Model.PageSize"
                                                   asp-route-search="@Context.Request.Query[" search"]"
                                                   asp-route-name="@Context.Request.Query[" name"]"
                                                   asp-route-phone="@Context.Request.Query[" phone"]"
                                                   asp-route-status="@Context.Request.Query[" status"]"
                                                   asp-route-country="@Context.Request.Query[" country"]"
                                                   asp-route-language="@Context.Request.Query[" language"]"
                                                   asp-route-channel="@Context.Request.Query[" channel"]"
                                                   asp-route-source="@Context.Request.Query[" source"]"
                                                   asp-route-sortColumn="PhoneNumber"
                                                   asp-route-sortDirection='(Context.Request.Query["sortColumn"] == "PhoneNumber" && Context.Request.Query["sortDirection"] == "asc") ? "desc" : "asc"'>
                                                    Phone No.
                                                    @if (Context.Request.Query["sortColumn"] == "PhoneNumber")
                                                    {
                                                    <i class='fa @(Context.Request.Query["sortDirection"] == "asc" ? "fa-arrow-up" : "fa-arrow-down")'></i>
                                                    }
                                                </a>
                                            </th>
                                            <th>Country</th>
                                            <th>Language</th>
                                            <th>Channel</th>
                                            <th>Source</th>
                                            <th>Status</th>
                                            <th class="text-center"><i class="icon-settings"></i></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (Model.Items != null && Model.Items.Any())
                                        {
                                        @foreach (var contact in Model.Items)
                                        {
                                        <tr>
                                            <td>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" value="@contact.Id">
                                                </div>
                                            </td>
                                            <td>@contact.DisplayName</td>
                                            <td>@contact.PhoneNumber</td>
                                            <td>@contact.Country</td>
                                            <td>@contact.Language</td>
                                            <td>channel name</td>
                                            <td>@contact.ImportSource</td>
                                            <td>
                                                <span class="badge status-badge @(contact.Email != null ? " status-enabled" : "status-disabled" )">
                                                    @(contact.Email != null ? "Enabled" : "Disabled")
                                                </span>
                                            </td>
                                            <td class="text-center">
                                                <button class="btn btn-sm btn-outline-secondary">
                                                    <i class="icon-pencil"></i>
                                                </button>
                                            </td>
                                        </tr>
                                        }
                                        }
                                        else
                                        {
                                        <tr>
                                            <td colspan="9" class="text-center">No contacts found</td>
                                        </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>

                            <!-- Pagination -->
                            @if (Model.TotalPages > 1)
                            {
                            <nav>
                                <ul class="pagination">
                                    @if (Model.HasPreviousPage)
                                    {
                                    <li class="page-item">
                                        <a class="page-link"
                                           asp-action="ManageContacts"
                                           asp-route-tenantId="1"
                                           asp-route-pageNumber="@(Model.PageNumber - 1)"
                                           asp-route-pageSize="@Model.PageSize"
                                           asp-route-search="@Context.Request.Query[" search"]"
                                           asp-route-name="@Context.Request.Query[" name"]"
                                           asp-route-phone="@Context.Request.Query[" phone"]"
                                           asp-route-status="@Context.Request.Query[" status"]"
                                           asp-route-country="@Context.Request.Query[" country"]"
                                           asp-route-language="@Context.Request.Query[" language"]"
                                           asp-route-channel="@Context.Request.Query[" channel"]"
                                           asp-route-source="@Context.Request.Query[" source"]"
                                           asp-route-sortColumn="@Context.Request.Query[" sortColumn"]"
                                           asp-route-sortDirection="@Context.Request.Query[" sortDirection"]">
                                            Previous
                                        </a>
                                    </li>
                                    }

                                    @for (int i = 1; i <= Model.TotalPages; i++)
                                    {
                                    <li class="page-item @(i == Model.PageNumber ? " active" : "" )">
                                        <a class="page-link"
                                           asp-action="ManageContacts"
                                           asp-route-tenantId="1"
                                           asp-route-pageNumber="@i"
                                           asp-route-pageSize="@Model.PageSize"
                                           asp-route-search="@Context.Request.Query[" search"]"
                                           asp-route-name="@Context.Request.Query[" name"]"
                                           asp-route-phone="@Context.Request.Query[" phone"]"
                                           asp-route-status="@Context.Request.Query[" status"]"
                                           asp-route-country="@Context.Request.Query[" country"]"
                                           asp-route-language="@Context.Request.Query[" language"]"
                                           asp-route-channel="@Context.Request.Query[" channel"]"
                                           asp-route-source="@Context.Request.Query[" source"]"
                                           asp-route-sortColumn="@Context.Request.Query[" sortColumn"]"
                                           asp-route-sortDirection="@Context.Request.Query[" sortDirection"]">
                                            @i
                                        </a>
                                    </li>
                                    }

                                    @if (Model.HasNextPage)
                                    {
                                    <li class="page-item">
                                        <a class="page-link"
                                           asp-action="ManageContacts"
                                           asp-route-tenantId="1"
                                           asp-route-pageNumber="@(Model.PageNumber + 1)"
                                           asp-route-pageSize="@Model.PageSize"
                                           asp-route-search="@Context.Request.Query[" search"]"
                                           asp-route-name="@Context.Request.Query[" name"]"
                                           asp-route-phone="@Context.Request.Query[" phone"]"
                                           asp-route-status="@Context.Request.Query[" status"]"
                                           asp-route-country="@Context.Request.Query[" country"]"
                                           asp-route-language="@Context.Request.Query[" language"]"
                                           asp-route-channel="@Context.Request.Query[" channel"]"
                                           asp-route-source="@Context.Request.Query[" source"]"
                                           asp-route-sortColumn="@Context.Request.Query[" sortColumn"]"
                                           asp-route-sortDirection="@Context.Request.Query[" sortDirection"]">
                                            Next
                                        </a>
                                    </li>
                                    }
                                </ul>
                            </nav>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const filterBtn = document.getElementById('filterBtn');
            const filterBox = document.getElementById('filterBox');

            // Initially hide the filter box
            filterBox.style.display = 'none';

            filterBtn.addEventListener('click', function () {
                if (filterBox.style.display === 'none') {
                    filterBox.style.display = 'block';
                } else {
                    filterBox.style.display = 'none';
                }
            });

            // Handle select all checkbox
            const selectAll = document.getElementById('selectAll');
            const itemCheckboxes = document.querySelectorAll('input[type="checkbox"].form-check-input');

            selectAll.addEventListener('change', function () {
                itemCheckboxes.forEach(checkbox => {
                    checkbox.checked = selectAll.checked;
                });
            });
        });
    </script>
    }
